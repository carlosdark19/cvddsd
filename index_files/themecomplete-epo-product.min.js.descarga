(function(e,t,n){"use strict";var s=function(e,t,n,s,o){var i=this;i.field=t,i.currentCart=n,i.variableProductContainers=s,i.epoObject=o,i.$form=e,i.$wrap=e.closest(".tc-epo-element-product-container-wrap"),i.$attributeFields=e.find(".tc-epo-variable-product-selector"),i.$singleVariation=e.find(".tc-epo-element-single-variation"),i.$resetVariations=e.find(".tc-epo-element-variable-reset-variations"),i.variationData=e.data("product_variations"),i.useAjax=!1===i.variationData,i.xhr=!1,i.loading=!0,i.variationId=e.closest(".tc-epo-element-product-li-container").find(".tc-epo-element-product-container-variation-id input.product-variation-id"),i.getChosenAttributes=i.getChosenAttributes.bind(i),i.findMatchingVariations=i.findMatchingVariations.bind(i),i.isMatch=i.isMatch.bind(i),i.toggleResetLink=i.toggleResetLink.bind(i),e.on("click.tc-variation-form",".tc-epo-element-variable-reset-variations",{variationForm:i},i.onReset),e.on("tc_hide_variation",{variationForm:i},i.onHide),e.on("tc_show_variation",{variationForm:i},i.onShow),e.on("tc_reset_data",{variationForm:i},i.onResetDisplayedVariation),e.on("tc_reset_image",{variationForm:i},i.onResetImage),e.on("change.tc-variation-form",".tc-epo-variable-product-selector",{variationForm:i},i.onChange),e.on("tc_found_variation.tc-variation-form",{variationForm:i},i.onFoundVariation),e.on("tc_check_variations.tc-variation-form",{variationForm:i},i.onFindVariation),e.on("tc_update_variation_values.tc-variation-form",{variationForm:i},i.onUpdateAttributes),e.on("refresh.tc-variation-form",{variationForm:i},i.onRefreshContainer),e.on("update_field.tc-variation-form",{variationForm:i},i.onUpdateField),i.variationId.val(""),setTimeout(function(){e.trigger("refresh"),e.trigger("tc_variation_form"),i.loading=!1},100)};s.prototype.onRefreshContainer=function(e){var t=e.data.variationForm;t.variableProductContainers.find(".tc-epo-element-product-container").removeClass("variations_form"),t.$form.addClass("variations_form"),t.$form.trigger("tc_check_variations.tc-variation-form")},s.prototype.onUpdateField=function(e,t){var n,i,a,r,c,o=e.data.variationForm,s=o.field;e.preventDefault(),t||(n=s,s.is("select")&&(n=s.find("option:selected")),i=0,a=0,r=0,c=0,s.data("price_set",1),n.data("associated_price_set",1),n.data("price_set",1),n.data("raw_price",a),n.data("raw_original_price",c),n.data("price",i),n.data("original_price",r),s.data("price-changed",1),o.$form.trigger({type:"tm-epo-update",norules:2}),o.currentCart.trigger({type:"tm-epo-update",norules:2}))},s.prototype.onReset=function(e){e.preventDefault(),e.data.variationForm.$attributeFields.val("").trigger("change"),e.data.variationForm.$form.trigger("tc_reset_data")},s.prototype.onHide=function(e){e.preventDefault()},s.prototype.onShow=function(e){e.preventDefault()},s.prototype.onResetDisplayedVariation=function(e){var t=e.data.variationForm;t.$form.find(".product-meta").find(".tc-product-sku").tc_reset_content(),t.$form.trigger("tc_reset_image"),t.$singleVariation.slideUp(200).trigger("tc_hide_variation")},s.prototype.onResetImage=function(e){e.data.variationForm.$form.tc_variations_image_update(!1)},s.prototype.onFindVariation=function(t){var i,a,r,n=t.data.variationForm,s=n.getChosenAttributes(),o=s.data;if(s.count===s.chosenCount)if(n.useAjax){if(typeof wc_add_to_cart_variation_params=="undefined")return;n.xhr&&n.xhr.abort(),i=n.$form.closest(".cpf-type-product"),n.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o.product_id=parseInt(n.$form.data("product_id"),10),o.discount=i.attr("data-discount"),o.discount_type=i.attr("data-discount-type"),o.discount_exclude_addons=i.attr("data-discount-exclude-addons"),n.xhr=e.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:o,success:function(e){e?n.$form.trigger("tc_found_variation",[e]):(n.$form.trigger("tc_reset_data"),s.chosenCount=0,n.loading||(n.$form.find(".tc-epo-element-single-variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),n.$form.find(".wc-no-matching-variations").slideDown(200),n.$form.trigger("update_field",[])))},complete:function(){n.$form.unblock()}})}else n.$form.trigger("tc_update_variation_values"),r=n.findMatchingVariations(n.variationData,o),a=r.shift(),a?n.$form.trigger("tc_found_variation",[a]):(n.$form.trigger("tc_reset_data"),s.chosenCount=0,n.loading||(n.$form.find(".tc-epo-element-single-variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),n.$form.find(".wc-no-matching-variations").slideDown(200)));else n.variationId.val("").trigger("change"),n.$form.trigger("tc_update_variation_values"),n.$form.trigger("tc_reset_data"),n.$form.trigger("update_field",[]);n.toggleResetLink(s.chosenCount>0)},s.prototype.onFoundVariation=function(t,n){var i=t.data.variationForm,h=i.$form.find(".product-meta").find(".tc-product-sku"),l=i.$wrap.find(".tm-quantity-alt"),s=l.find("input.tm-qty-alt"),a=e.epoAPI.math.toInt(s.attr("data-min")),r=e.epoAPI.math.toInt(s.attr("data-max")),m=s.attr("data-max"),d=!0,u=!1,c="";n.sku?h.tc_set_content(n.sku):h.tc_reset_content(),i.$form.tc_variations_image_update(n),n.variation_is_visible?u=o("variation-template"):u=o("unavailable-variation-template"),i.field.attr("data-no-price")&&(n.display_price="",n.display_regular_price="",n.price_html=""),i.$form.find(".tc-epo-element-product-container-cart").find(".stock").remove(),c=u({variation:n}),c=c.replace("/*<![CDATA[*/",""),c=c.replace("/*]]>*/",""),i.$singleVariation.html(c),i.variationId.val(n.variation_id).trigger("change"),n.is_sold_individually==="yes"?(s.val("1").attr("min","1").attr("max","1"),l.hide()):(n.min_qty!==""&&n.min_qty>a&&a>0&&(a=n.min_qty),n.max_qty!==""&&n.max_qty<r&&(r=n.max_qty),a!==""?s.attr("min",a):s.removeAttr("min"),m!==""?s.attr("max",r):s.removeAttr("max"),r&&e.epoAPI.math.toInt(s.val())>r&&s.val(r),a>e.epoAPI.math.toInt(s.val())&&s.val(a),l.show()),(!n.is_purchasable||!n.is_in_stock||!n.variation_is_visible)&&(d=!1,s.val("0").attr("min","0").attr("max","0"),l.hide()),s.trigger("change"),e.epoAPI.util.trim(i.$singleVariation.text())?i.$singleVariation.slideDown(200).trigger("tc_show_variation",[n,d]):i.$singleVariation.show().trigger("tc_show_variation",[n,d]),i.$form.trigger("update_field",[n])},s.prototype.onChange=function(e){var t=e.data.variationForm,n=t.field;t.variationId.val("").trigger("change"),t.$form.find(".wc-no-matching-variations").remove(),t.useAjax?t.$form.trigger("tc_check_variations"):(t.$form.trigger("woocommerce_variation_select_change"),t.$form.trigger("tc_check_variations")),t.$form.trigger("woocommerce_variation_has_changed"),setTimeout(function(){n.closest(".tcowl-carousel").trigger("refresh.owl.carousel")},50)},s.prototype.onUpdateAttributes=function(t){var n=t.data.variationForm,s=n.getChosenAttributes(),o=s.data;if(n.useAjax)return;n.$attributeFields.each(function(t,s){var r,l,d,u,m,f,p,v,b,y,_,w,x,i=e(s),O=i.data("attribute_name")||i.attr("name"),C=e(s).data("show_option_none"),g=":gt(0)",j=0,a=e("<select/>"),c=i.val()||"",h=!0;i.data("attribute_html")||(m=i.clone(),m.find("option").prop("disabled",!1).prop("selected",!1).removeAttr("attached"),i.data("attribute_options",m.find("option"+g).get()),i.data("attribute_html",m.html())),a.html(i.data("attribute_html")),y=e.extend(!0,{},o),y[O]="",r=n.findMatchingVariations(n.variationData,y);for(d in r)if(typeof r[d]!="undefined"){b=r[d].attributes;for(u in b)if(Object.prototype.hasOwnProperty.call(b,u)&&(l=b[u],p="",u===O))if(r[d].variation_is_active&&(p="enabled"),l){if(l=e("<div/>").html(l).text(),f=a.find("option"),f.length)for(v=0,w=f.length;v<w;v++)if(_=e(f[v]),x=_.val(),l===x){_.addClass("attached "+p);break}}else a.find("option:gt(0)").addClass("attached "+p)}j=a.find("option.attached").length,c&&(h=!1,0!==j&&a.find("option.attached.enabled").each(function(){var t=e(this).val();if(c===t)return h=!0,!1})),j>0&&c&&h&&"no"===C&&(a.find("option:first").remove(),g=""),a.find("option"+g+":not(.attached)").remove(),i.html(a.html()),i.find("option"+g+":not(.enabled)").prop("disabled",!0),c?h?i.val(c):i.val("").trigger("change"):i.val("")}),n.$form.trigger("woocommerce_update_variation_values")},s.prototype.getChosenAttributes=function(){var t={},n=0,s=0;return this.$attributeFields.each(function(){var i=e(this).data("attribute_name")||e(this).attr("name"),o=e(this).val()||"";o.length>0&&s++,n++,t[i]=o}),{count:n,chosenCount:s,data:t}},s.prototype.findMatchingVariations=function(e,t){var n,s,o=[];for(n=0;n<e.length;n++)s=e[n],this.isMatch(s.attributes,t)&&o.push(s);return o},s.prototype.isMatch=function(e,t){var n,s,o,i=!0;for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n=e[o],s=t[o],n!==void 0&&s!==void 0&&n.length!==0&&s.length!==0&&n!==s&&(i=!1));return i},s.prototype.toggleResetLink=function(e){e?this.$resetVariations.css("visibility")==="hidden"&&this.$resetVariations.css("visibility","visible").hide().fadeIn():this.$resetVariations.css("visibility","hidden")},e.fn.tc_product_variation_form=function(e,t,n,o){return new s(this,e,t,n,o),this.trigger("tc_product_variation_form"),this},e.fn.tc_set_content=function(e){void 0===this.attr("data-o_content")&&this.attr("data-o_content",this.text()),this.text(e)},e.fn.tc_reset_content=function(){void 0!==this.attr("data-o_content")&&this.text(this.attr("data-o_content"))},e.fn.tc_set_variation_attr=function(e,t){void 0===this.attr("data-o_"+e)&&this.attr("data-o_"+e,this.attr(e)?this.attr(e):""),!1===t?this.removeAttr(e):this.attr(e,t)},e.fn.tc_reset_variation_attr=function(e){void 0!==this.attr("data-o_"+e)&&this.attr(e,this.attr("data-o_"+e))},e.fn.tc_variations_image_update=function(e){var s=this,n=s.find(".tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),t=n.find(".wp-post-image"),o=n.find("a").eq(0);e&&e.image&&e.image.src&&e.image.src.length>1?(t.tc_set_variation_attr("src",e.image.src),t.tc_set_variation_attr("height",e.image.src_h),t.tc_set_variation_attr("width",e.image.src_w),t.tc_set_variation_attr("srcset",e.image.srcset),t.tc_set_variation_attr("sizes",e.image.sizes),t.tc_set_variation_attr("title",e.image.title),t.tc_set_variation_attr("data-caption",e.image.caption),t.tc_set_variation_attr("alt",e.image.alt),t.tc_set_variation_attr("data-src",e.image.full_src),t.tc_set_variation_attr("data-large_image",e.image.full_src),t.tc_set_variation_attr("data-large_image_width",e.image.full_src_w),t.tc_set_variation_attr("data-large_image_height",e.image.full_src_h),n.tc_set_variation_attr("data-thumb",e.image.src),o.tc_set_variation_attr("href",e.image.full_src)):s.tc_variations_image_reset()},e.fn.tc_variations_image_reset=function(){var n=this,t=n.find(".tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),e=t.find(".wp-post-image"),s=t.find("a").eq(0);e.tc_reset_variation_attr("src"),e.tc_reset_variation_attr("width"),e.tc_reset_variation_attr("height"),e.tc_reset_variation_attr("srcset"),e.tc_reset_variation_attr("sizes"),e.tc_reset_variation_attr("title"),e.tc_reset_variation_attr("data-caption"),e.tc_reset_variation_attr("alt"),e.tc_reset_variation_attr("data-src"),e.tc_reset_variation_attr("data-large_image"),e.tc_reset_variation_attr("data-large_image_width"),e.tc_reset_variation_attr("data-large_image_height"),t.tc_reset_variation_attr("data-thumb"),s.tc_reset_variation_attr("href")};function o(e){var o=n.getElementById("tmpl-"+e).textContent,s=!1,s=s||/<#\s?data\./.test(o),s=s||/{{{?\s?data\.(?!variation\.).+}}}?/.test(o),s=s||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(o);return s?t.wp.template(e):function(n){var s,i=n.variation||{};return o.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,function(e,n,o,a){return n.length!==a.length?"":(s=i[o]||"",n.length===2?t.escape(s):s)})}}})(window.jQuery,window,document)