(function(e,t){"use strict";var n,s=function(e,n){return this.targets=t(e),this.settings=t.extend({},t.fn.tcToolTip.defaults,n),this.targets.length>0&&(this.init(),this)};t(function(){n=e.TMEPOJS||{tm_epo_global_tooltip_max_width:"340px"}}),s.prototype={constructor:s,removeTooltip:function(n,s){var o=this.settings;if(n.data("is_moving"))return;s.removeClass(o.fadin).addClass(o.fadeout),s.animate({opacity:0},o.speed,function(){t(this).remove()}),n.data("tmtip-title")&&n.data("tm-tip-html")===void 0&&!n.attr("data-tm-tooltip-html")&&n.attr("title",n.data("tmtip-title")),t(e).off("scroll.tcToolTip resize.tcToolTip"),o.onetime&&this.destroy()},initTooltip:function(s,o,i){var a,r,c,d,u,h,l=this.settings;s&&o&&s.length===1&&o.length===1&&s.data("tm-has-tm-tip")===1&&(i===1&&(s.data("tm-tip-html")!==void 0?c=s.data("tm-tip-html"):s.attr("data-tm-tooltip-html")?c=s.attr("data-tm-tooltip-html"):c=s.attr("title"),o.html(c),s.data("is_moving",!0)),o.find("aside").hide(),n.tm_epo_global_tooltip_max_width===""?t(e).width()<=o.outerWidth()*1.2?o.css("max-width",t(e).width()/1.2+"px"):o.css("max-width","340px"):(n.tm_epo_global_tooltip_max_width.isNumeric()&&(n.tm_epo_global_tooltip_max_width=n.tm_epo_global_tooltip_max_width+"px"),o.css("max-width",n.tm_epo_global_tooltip_max_width)),o.find("aside").show(),o.css({left:"",right:"",top:""}),d=t.epoAPI.dom.scroll(),a=s.offset().left+s.outerWidth()/2-o.outerWidth()/2,h=a,a<0?(a=s.offset().left+s.outerWidth()/2-20,o.addClass("left")):o.removeClass("left"),h>=0&&a+o.outerWidth()>t(e).width()?(a=s.offset().left-o.outerWidth()+s.outerWidth()/2+20,a<0&&(a=a-10,o.css("max-width","calc("+o.css("max-width")+" - "+Math.abs(a)+"px)"),a=10),o.addClass("right")):o.removeClass("right"),o.css({left:a,right:"auto",top:r}),r=s.offset().top-o.outerHeight()-10,u=s.offset().top-d.top-o.outerHeight()-10,r<0||u<0?(r=s.offset().top+s.outerHeight()+10,o.addClass("top"),o.removeClass("bottom")):(o.removeClass("top"),o.addClass("bottom")),t(e).trigger("tm_tooltip_show"),i?(o.css({left:a,top:r}),s.data("is_moving",!1)):o.css({left:a,top:r}).removeClass(l.fadeout).addClass(l.fadin))},show:function(n){var s,o,a,i=this.settings;if(n.data("is_moving"))return;return n.data("tm-has-tm-tip")===1&&(n.data("tm-tip-html")!==void 0?(o=n.data("tm-tip-html"),n.attr("title")&&n.data("tmtip-title",n.attr("title")),n.removeAttr("title")):n.attr("data-tm-tooltip-html")?(o=n.attr("data-tm-tooltip-html"),n.attr("title")&&n.data("tmtip-title",n.attr("title")),n.removeAttr("title")):o=n.attr("title"),o!==void 0&&(t("#tm-tooltip").remove(),i.tipclass?i.tipclass=" "+i.tipclass:i.tipclass="",s=t('<div id="tm-tooltip" class="tm-tip tm-animated'+i.tipclass+'"></div>'),s.css("opacity",0).html(o).appendTo("body"),a=s.find("img"),a.length>0&&a.on("load",this.initTooltip.bind(this,n,s)),this.initTooltip(n,s),t(e).on("scroll.tcToolTip resize.tcToolTip",this.initTooltip.bind(this,n,s)),n.data("is_moving",!1),n.on("tmmovetooltip",this.initTooltip.bind(this,n,s,1)),n.on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,n,s)),n.closest("label").on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,n,s)),s.on("click",this.removeTooltip.bind(this,n,s)))),!1},destroy:function(){this.targets.length>0&&(this.targets.toArray().forEach(function(e){var n=t(e);n.closest("off").on("mouseleave.tc tmhidetooltip"),n.off("tc-tooltip-html-changed tmmovetooltip tmhidetooltip mouseenter.tc mouseleave.tc tmshowtooltip.tc"),n.removeData("tmtip-title"),n.removeData("tm-tip-html")}),this.targets.removeData("tctooltip tm-has-tm-tip is_moving"))},init:function(){var e=this,n=this.settings;this.targets.length>0&&this.targets.toArray().forEach(function(s){var i,r,c,l,d,u,h,m,f,p,g,v,b,j,o=t(s),a=n.tip||void 0;o.data("tm-has-tm-tip")===void 0&&(b=o.attr("data-tm-tooltip-swatch"),v=o.attr("data-tm-tooltip-swatch-desc"),g=o.attr("data-tm-tooltip-swatch-lbl-desc"),p=o.attr("data-tm-tooltip-swatch-img"),h=o.attr("data-tm-tooltip-swatch-img-lbl"),m=o.attr("data-tm-tooltip-swatch-img-desc"),f=o.attr("data-tm-tooltip-swatch-img-lbl-desc"),o.data("tm-has-tm-tip",1),o.attr("data-original")!==void 0?c=o.attr("data-original"):o.attr("src")!==void 0?o.attr("data-src")!==void 0?c=o.attr("data-src"):c=o.attr("src"):c=o[0].src,i=o.closest(".tmcp-field-wrap"),i.is(".tc-epo-element-product-holder")&&(i=o.closest(".cpf-element")),i.length===0&&(i=o.closest(".cpf-element")),i.is(".cpf-type-product")&&o.closest(".tm-epo-element-label").length===0&&o.closest(".cpf-section").length&&(i=o.closest(".cpf-section").find(".tc-section-inner-wrap .tm-section-description.tm-description")),i.length===0&&(i=o.closest(".cpf-section").find(".tc-section-inner-wrap .tm-section-description.tm-description")),r=i.find(".tm-tip-html"),r.length===0&&(r=i.find(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline")),r.length===0&&(r=i.next(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline,.tm-tip-html")),r.length===0&&i.is(".tm-description")&&(r=i),i=r,r=t(i),d=r.find(".tc-label-text"),d.length||(d=r),j=o.attr("data-tm-hide-label")==="yes"||o.attr("data-tm-hide-label")===void 0||r.is(".tm-tip-html"),l="",u=o.closest(".tmcp-field-wrap"),u=u.find("[data-tm-tooltip-html]"),u.length===0?(u=o.closest(".tmcp-field-wrap").find(".tc-inline-description"),u.length>0&&(l=u.html())):l=u.attr("data-tm-tooltip-html"),a===void 0?(b?a=d.html():v&&l!==""?a="<aside>"+l+"</aside>":g&&(d.html()!==""||l!=="")?a="<aside>"+d.html()+"</aside><aside>"+l+"</aside>":p&&c!==""?a='<img src="'+c+'">':h&&(d.html()!==""||c!=="")?a='<img src="'+c+'"><aside>'+d.html()+"</aside>":m&&(c!==""||l!=="")?a='<img src="'+c+'"><aside>'+l+"</aside>":f&&(d.html()!==""||c!==""||l!=="")&&(a='<img src="'+c+'"><aside>'+d.html()+"</aside><aside>"+l+"</aside>"),a!==void 0&&(o.data("tm-tip-html",a),j&&(r.find(".tm-tooltip").remove(),d.hide())),a===void 0&&(o.attr("data-tm-tooltip-html")?a=o.attr("data-tm-tooltip-html"):a=o.attr("title"))):o.data("tm-tip-html",a),o.on("tc-tooltip-html-changed",function(){o.attr("data-tm-tooltip-html")?o.show():o.hide()}),o.is("img")&&o.closest("label").on("mouseenter tmshowtooltip",e.show.bind(e,o)),o.on("mouseenter.tc tmshowtooltip.tc",e.show.bind(e,o)),n.trigger&&e.show(o))})}},t.fn.tcToolTip=function(e){var n,i,a,r,o=t(this),c=o.map(function(){return t(this).data("tctooltip")||""}).get().some(function(e){return e===""});return typeof e=="object"?a=e:a={},c&&(n=new s(this,a),o.data("tctooltip",n)),typeof e=="string"&&(n=o.data("tctooltip"),i=n[e].apply(n,[])),i===void 0?r=o:r=i,r},t.fn.tcToolTip.defaults={fadin:"fadein",fadeout:"fadeout",speed:1500},t.fn.tcToolTip.instances=[],t.fn.tcToolTip.Constructor=s,t.tcToolTip=function(e,n){var i,o=!1;return e=e||t(".tm-tooltip"),i=e.map(function(){return t(this).data("tctooltip")||""}).get().some(function(e){return e===""}),i&&(o=new s(e,n),e.data("tctooltip",o)),o}})(window,window.jQuery)